var CubeViz_ConfigurationLink=(function(){function b(){}b.save=function a(c,f,d,h){var g=$.ajaxSetup();var e=$.support.cors;$.ajaxSetup({async:true,cache:false,type:"POST"});$.support.cors=true;$.ajax({url:c+"savecontenttofile/",data:{type:d,stringifiedContent:JSON.stringify(f)}}).error(function(k,i,j){$.ajaxSetup(g);$.support.cors=e;throw new Error("save error: "+k.responseText)}).done(function(i){$.ajaxSetup(g);$.support.cors=e;h(i)})};return b})();var CubeViz_Collection=(function(){function a(b){this.reset(b)}a.prototype.add=function(b,c){if(true===_.isUndefined(b[this.idKey])){throw new Error("Key "+this.idKey+" in element not set!");return this}if(undefined===this.get(b[this.idKey])){this._.push(b)}else{if((undefined!==c&&undefined!==c.merge&&c.merge==true)){this.remove(b[this.idKey]);this._.push(b)}}return this};a.prototype.addList=function(c){var b=this;if(true==_.isArray(c)){_.each(c,function(d){b.add(d)})}else{if(true==_.isObject(c)){this.addList(_.values(c))}}return b};a.prototype.each=function(b){_.each(this._,b);return this};a.prototype.exists=function(b){return false===_.isUndefined(this.get(b))};a.prototype.get=function(d){var b=this;var c=_.filter(this._,function(e){if(e[b.idKey]==d){return true}else{return false}});return 1==c.length?c[0]:undefined};a.prototype.getFirst=function(){return _.first(this._)};a.prototype.remove=function(c){var b=this;this._=_.reject(this._,function(d){return d[b.idKey]==c});return this};a.prototype.reset=function(b){this.idKey=undefined===b?(undefined===this.idKey?"id":this.idKey):b;this._=[];return this};a.prototype.size=function(){return _.size(this._)};a.prototype.sortAscendingBy=function(g){var f="";var e="";var j="";var i="";var h=false===_.isUndefined(g)?g:this.idKey;this._.sort(function(d,c){try{try{j=parseFloat(d[h]);i=parseFloat(c[h]);if(true===_.isNaN(j)||true===_.isNaN(i)){throw new Error()}}catch(k){j=d[h].toUpperCase();i=c[h].toUpperCase()}return(j<i)?-1:(j>i)?1:0}catch(l){}});return this};a.prototype.toObject=function(){var b=0;var c={};_.each(this._,function(d){c[b++]=d});return c};return a})();var CubeViz_Visualization=(function(){function CubeViz_Visualization(){}CubeViz_Visualization.prototype.getName=function(){return this.name};CubeViz_Visualization.prototype.getSupportedClassNames=function(){return this.supportedClassNames};CubeViz_Visualization.prototype.load=function(c){if(true===this.isResponsibleFor(c)){var chartInstance;eval("chartInstance = new "+c+"();");return chartInstance}throw new Error("Invalid c ("+c+") given!")};CubeViz_Visualization.prototype.isResponsibleFor=function(className){return _.contains(this.getSupportedClassNames(),className)};return CubeViz_Visualization})();var CubeViz_View_Abstract=(function(){function a(d,b,c){this.app=c;this.attachedTo=b;this.autostart=false;this.collection=new CubeViz_Collection();this.id=d||"view"}a.prototype.bindGlobalEvents=function(b){this.app.bindGlobalEvents(b,this);return this};a.prototype.bindUserInterfaceEvents=function(e){if(true===_.isUndefined(e)||0==_.size(e)){return}var d="";var b="";var c=this;_.each(e,function(g,f){if(false===_.isFunction(g)){g=c[g]}if(!g){throw new Error("Method "+g+" does not exist")}d=f.substr(0,f.indexOf(" "));b=f.substr(f.indexOf(" ")+1);$(b).on(d,$.proxy(g,c))})};a.prototype.destroy=function(){var b=$(this.attachedTo);b.off();if(true===b.is("div")){b.empty()}else{if(true===b.is("select")){b.find("option").remove()}}this.collection.reset();return this};a.prototype.initialize=function(){};a.prototype.triggerGlobalEvent=function(b,c){this.app.triggerEvent(b,c);return this};return a})();var CubeViz_View_Application=(function(){function CubeViz_View_Application(){this._viewInstances=new CubeViz_Collection();this._eventHandlers=new CubeViz_Collection();this._={}}CubeViz_View_Application.prototype.add=function(id,attachedTo,merge){var options=true===merge?{merge:true}:undefined;var viewObj={alreadyRendered:false,attachedTo:attachedTo,id:id,instance:null};eval("viewObj.instance = new "+id+'("'+attachedTo+'", this);');this._viewInstances.add(viewObj,options);return this};CubeViz_View_Application.prototype.bindGlobalEvents=function(events,callee){if(true===_.isUndefined(events)||0==_.size(events)){return this}var self=this;_.each(events,function(event){$(self).on(event.name,$.proxy(event.handler,callee))});return this};CubeViz_View_Application.prototype.destroyView=function(id){this._viewInstances.get(id).instance.destroy();return this};CubeViz_View_Application.prototype.get=function(id){return this._viewInstances.get(id)};CubeViz_View_Application.prototype.getDataCopy=function(){var backup=[this._.generatedVisualization];this._.generatedVisualization=undefined;var result=$.parseJSON(JSON.stringify(this._));this._.generatedVisualization=backup[1];return result};CubeViz_View_Application.prototype.remove=function(id){this._viewInstances.remove(id);return this};CubeViz_View_Application.prototype.renderAll=function(){var self=this;_.each(this._viewInstances._,function(view){self.renderView(view.id,view.attachedTo)});return this};CubeViz_View_Application.prototype.renderView=function(id,attachedTo){this.add(id,attachedTo).destroyView(id).get(id).instance.initialize();return this};CubeViz_View_Application.prototype.reset=function(){$(this).off();var self=this;_.each(this._viewInstances._,function(view){self.destroyView(view.id).add(view.id,view.attachedTo,true)});return this};CubeViz_View_Application.prototype.restoreDataCopy=function(copy){this._=$.parseJSON(JSON.stringify(copy));return this};CubeViz_View_Application.prototype.triggerEvent=function(eventName,data){$(this).trigger(eventName,[data]);return this};CubeViz_View_Application.prototype.unbindEvent=function(eventName){$(this).off(eventName);return this};return CubeViz_View_Application})();var CubeViz_View_Helper=(function(){function f(){}f.attachDialogTo=function k(p,o){var n={};var o=o||{};n.autoOpen=o.autoOpen||false;n.closeOnEscape=o.closeOnEscape||false;n.draggable=o.draggable||false;n.height=o.height||"auto";n.hide=o.hide||"slow";n.modal=o.modal||true;n.overlay=o.overlay||{"background-color":"#FFFFFF",opacity:0.5};n.resizable=o.resizable||false;n.show=o.show||"slow";n.width=o.width||"700";if(true===_.isUndefined(o.showCross)||false===o.showCross){n.open=function(q,r){$(".ui-dialog-titlebar-close",$(this).parent()).hide()}}p.dialog(n);p.data("hasDialog",true)};f.closeDialog=function e(n){n.dialog("close");n.data("isDialogOpen",false)};f.destroyDialog=function m(n){n.dialog("destroy");n.data("isDialogOpen",false)};f.hideCloseAndUpdateSpinner=function j(n){$(n.find(".cubeviz-dataSelectionModule-closeUpdateSpinner").first()).hide()};f.hideLeftSidebarSpinner=function c(){$("#cubeviz-dataSelectionModule-spinner").fadeOut("slow",function(){$("#cubeviz-dataSelectionModule-dataSelection").fadeIn("slow")})};f.openDialog=function d(n){n.dialog("open");n.data("isDialogOpen",true);$(".ui-widget-overlay").css("height",2*screen.height)};f.showCloseAndUpdateSpinner=function i(n){$(n.find(".cubeviz-dataSelectionModule-closeUpdateSpinner").first()).show()};f.showLeftSidebarSpinner=function b(){$("#cubeviz-dataSelectionModule-dataSelection").fadeOut("slow",function(){$("#cubeviz-dataSelectionModule-spinner").fadeIn("slow")})};f.sortLiItemsByAlphabet=function h(r){var o="";var n="";var q={};var p=[];r.sort(function(t,s){t=$(t).text().toUpperCase();s=$(s).text().toUpperCase();return(t<s)?-1:(t>s)?1:0});_.each(r,function(s){q=$(s).data("data");s=$(s).clone();$(s).data("data",q);p.push(s)});return p};f.sortLiItemsByCheckStatus=function l(q){var p={};var n=[];var o=[];_.each(q,function(r){if($($(r).children().first()).is(":checked")){p=$(r).data("data");r=$(r).clone();$(r).data("data",p);o.push(r)}else{n.push(r)}});_.each(n,function(r){p=$(r).data("data");r=$(r).clone();$(r).data("data",p);o.push(r)});return o};f.sortLiItemsByObservationCount=function a(s,u,t){var n="";var r=[];var p=[];var q=0;var o=[];_.each(s,function(v){n=$($(v).children().first()).val();q=0;_.each(t,function(w){if(n===w[u][0].value){++q}});$(v).data("observationCount",q);if(0<q){o.push($(v).clone())}else{p.push(v)}});o.sort(function(w,v){w=$(w).data("observationCount");v=$(v).data("observationCount");return(w<v)?1:(w>v)?-1:0});_.each(p,function(v){o.push($(v).clone())});return o};f.tplReplace=function g(n,p){if(true===_.isUndefined(p)){return n}var o=_.keys(p);_.each(o,function(q){n=n.replace("[["+q+"]]",_.str.trim(p[q]))});return _.str.trim(n)};return f})();var CubeViz_Visualization_Controller=(function(){function CubeViz_Visualization_Controller(){}CubeViz_Visualization_Controller.getColor=function getColor(variable){var color="#FFFFFF";if(true===_.isString(variable)||true===_.isNumber(variable)){color=""+CryptoJS.MD5(variable);color="#"+color.substr((color.length-6),6)}else{if(false===_.isUndefined(variable)){color=JSON.stringify(variable);color="#"+color.substr((color.length-6),6)}}return color};CubeViz_Visualization_Controller.getFromChartConfigByClass=function getFromChartConfigByClass(className,charts){var result=undefined;_.each(charts,function(chart){if(true===_.isUndefined(result)){if(className==chart.className){result=chart}}});return result};CubeViz_Visualization_Controller.getMultipleDimensions=function getMultipleDimensions(selectedComponentDimensions){var multipleDimensions=[];_.each(selectedComponentDimensions,function(selectedDimension){if(2<=_.keys(selectedDimension.__cv_elements).length){multipleDimensions.push(selectedDimension)}});return multipleDimensions};CubeViz_Visualization_Controller.getObjectValueByKeyString=function getObjectValueByKeyString(keyString,objToAccess){var call="objToAccess";var result=undefined;try{_.each(keyString.split("."),function(key){call+="."+key});eval("result = "+call)}catch(ex){}return result};CubeViz_Visualization_Controller.getOneElementDimensions=function getOneElementDimensions(selectedComponentDimensions){var oneElementDimensions=[];_.each(selectedComponentDimensions,function(selectedDimension){if(1==_.keys(selectedDimension.__cv_elements).length){oneElementDimensions.push(selectedDimension)}});return oneElementDimensions};CubeViz_Visualization_Controller.getVisualizationType=function getVisualizationType(className){var hC=new CubeViz_Visualization_HighCharts();if(true===hC.isResponsibleFor(className)){return hC.getName()}throw new Error("Unknown className "+className)};CubeViz_Visualization_Controller.linkify=function linkify(inputText){var emailAddressPattern=/\w+@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6})+/gim;var pseudoUrlPattern=/(^|[^\/])(www\.[\S]+(\b|$))/gim;var urlPattern=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim;return inputText.replace(urlPattern,'<a href="$&" target="_blank">$&</a>').replace(pseudoUrlPattern,'$1<a href="http://$2" target="_blank">$2</a>').replace(emailAddressPattern,'<a href="mailto:$&">$&</a>')};CubeViz_Visualization_Controller.setChartConfigClassEntry=function setChartConfigClassEntry(className,charts,newValue){for(var i in charts){if(className==charts[i].className){charts[i]=newValue}}};CubeViz_Visualization_Controller.updateVisualizationSettings=function updateVisualizationSettings(menuItemValues,visualizationSetting,chartConfigEntryDefaultConfig){var call="";var optionKey="";var optionVal="";var updatedSetting=visualizationSetting||{};if(0===_.keys(updatedSetting).length){updatedSetting=chartConfigEntryDefaultConfig}updatedSetting=$.parseJSON(JSON.stringify(updatedSetting));_.each(menuItemValues,function(menuItemValue){optionKey=$(menuItemValue).data("key");optionVal=$(menuItemValue).val();if(true===_.isUndefined(optionKey)){return}call="updatedSetting";_.each(optionKey.split("."),function(key){call+="."+key;eval(call+" = "+call+" || {};")});eval(call+" = optionVal;")});return updatedSetting};return CubeViz_Visualization_Controller})();var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var CubeViz_Visualization_HighCharts=(function(b){__extends(a,b);function a(){b.call(this);this.name="HighCharts";this.supportedClassNames=["CubeViz_Visualization_HighCharts_Area","CubeViz_Visualization_HighCharts_AreaSpline","CubeViz_Visualization_HighCharts_Bar","CubeViz_Visualization_HighCharts_GBar","CubeViz_Visualization_HighCharts_Column","CubeViz_Visualization_HighCharts_Line","CubeViz_Visualization_HighCharts_Pie","CubeViz_Visualization_HighCharts_Polar","CubeViz_Visualization_HighCharts_Spline"]}return a})(CubeViz_Visualization);var CubeViz_Visualization_HighCharts_Chart=(function(){function a(){}a.prototype.init=function(q,k,h,e,b,f,j){var c={};var o=0;var y=null;var n=null;var t=0;var z=new DataCube_Observation();var p=this;this.chartConfig=q;this.chartConfig.series=[];if(true===_.isUndefined(p.chartConfig.xAxis)){this.chartConfig.xAxis={categories:[]}}else{this.chartConfig.xAxis.categories=[]}this.chartConfig.title.text="";if(true===_.isUndefined(this.chartConfig.xAxis)){this.chartConfig.xAxis={title:{text:""}}}if(true===_.isUndefined(this.chartConfig.yAxis)){this.chartConfig.yAxis={title:{text:""}}}_.each(h,function(i){if(2>_.keys(i.__cv_elements).length){return}if(null==y){y=i["http://purl.org/linked-data/cube#dimension"]}else{n=i["http://purl.org/linked-data/cube#dimension"]}});if(null==n){_.each(h,function(i){if(1==_.keys(i.__cv_elements).length&&null==n){n=i["http://purl.org/linked-data/cube#dimension"]}})}this.chartConfig._cubeVizVisz=this.chartConfig._cubeVizVisz||{};if("true"==this.chartConfig._cubeVizVisz.doSwitchingAxes){var w=y;y=n;n=w}z.initialize(k,h,f);if(false===_.str.isBlank(y)&&false===_.str.isBlank(n)){var v=z.getAxesElements(y);_.each(v,function(i){p.chartConfig.xAxis.categories.push(i.self.__cv_niceLabel);c[i.self.__cv_uri]=t++});var d=[];_.each(h,function(i){d.push(i["http://purl.org/linked-data/cube#dimension"])});var m={};var l=z.getAxesElements(n);var u="";var s={};p.chartConfig.series=[];_.each(l,function(i){m={color:CubeViz_Visualization_Controller.getColor(i.self.__cv_uri),data:[],name:i.self.__cv_niceLabel,__cv_uri:i.self.__cv_uri};for(t=0;t<_.size(p.chartConfig.xAxis.categories);++t){m.data.push(null)}_.each(i.observations,function(A){if((false===_.isNull(j)&&(true===_.isNull(A[j])||true===_.isUndefined(A[j])))&&j!==A["http://purl.org/linked-data/cube#attribute"]){return}u="";_.each(d,function(B){u+=A[B]});if(true===_.isUndefined(s[u])){s[u]=true}else{return}if(false===_.isUndefined(A[f])){m.data[c[A[y]]]=parseFloat(A[f])}else{m.data[c[A[y]]]=null}});if(0==_.size(m.data)){}else{p.chartConfig.series.push(m)}})}else{if(false===_.str.isBlank(y)||false===_.str.isBlank(n)){if(false===_.str.isBlank(y)){var g=null;var x=[];var v=z.getAxesElements(y);var r=0;_.each(v,function(i){g=i.observations[_.keys(i.observations)[0]];if(false===_.isNull(j)&&(true===_.isNull(g[j])||true===_.isUndefined(g[j]))){return}p.chartConfig.xAxis.categories.push(i.self.__cv_niceLabel);x.push(g[f])});this.chartConfig.series=[{name:".",data:x}]}else{var g=null;var x=[];var l=z.getAxesElements(n);var r=0;this.chartConfig.xAxis.categories=["."];_.each(l,function(i){g=i.observations[_.keys(i.observations)[0]];if(false===_.isNull(j)&&(true===_.isNull(g[j])||true===_.isUndefined(g[j]))){return}p.chartConfig.series.push({name:i.self.__cv_niceLabel,data:[g[f]]})})}}}return this};a.prototype.getRenderResult=function(){return this.chartConfig};a.prototype.rendered=function(b){};a.prototype.onDestroy=function(){};return a})();var CubeViz_Visualization_HighCharts_Area=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_AreaSpline=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Bar=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);function chartClickHandler(){var a=this.cv_chart;if(a.canDrillX(this.xAxisElement)){a.chartConfig.xRoot=this.xAxisElement.self.__cv_uri}if(a.canDrillY(this.seriesElement)){a.chartConfig.yRoot=this.seriesElement.self.__cv_uri}a.rerender()}var CubeViz_Visualization_HighCharts_GBar=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}b.prototype.init=function(f,h,c,g,i,e,d){this.originalConfiguration={chartConfig:f,retrievedObservations:h,selectedComponentDimensions:c,multipleDimensions:g,oneElementDimensions:i,selectedMeasureUri:e,selectedAttributeUri:d};this.hierarchy=new DataCube_Hierarchy();this.bottomOnly=false;this.drillType="both";this.updateConfiguration();return this};b.prototype.updateConfiguration=function(){var h=this.originalConfiguration.chartConfig;var d=this.originalConfiguration.retrievedObservations;var g=this.originalConfiguration.selectedComponentDimensions;var k=this.originalConfiguration.multipleDimensions;var r=this.originalConfiguration.oneElementDimensions;var o=this.originalConfiguration.selectedMeasureUri;var c=this.originalConfiguration.selectedAttributeUri;var p=null;var i=null;var m=new DataCube_Observation();var q=this;this.chartConfig=h;this.chartConfig.series=[];if(true===_.isUndefined(q.chartConfig.xAxis)){this.chartConfig.xAxis={categories:[]}}else{this.chartConfig.xAxis.categories=[]}this.chartConfig.title.text="";if(true===_.isUndefined(this.chartConfig.xAxis)){this.chartConfig.xAxis={title:{text:""}}}if(true===_.isUndefined(this.chartConfig.yAxis)){this.chartConfig.yAxis={title:{text:""}}}_.each(g,function(t){if(2>_.keys(t.__cv_elements).length){return}if(null==p){p=t["http://purl.org/linked-data/cube#dimension"]}else{i=t["http://purl.org/linked-data/cube#dimension"]}});if(null==i){_.each(g,function(t){if(1==_.keys(t.__cv_elements).length&&null==i){i=t["http://purl.org/linked-data/cube#dimension"]}})}this.chartConfig._cubeVizVisz=this.chartConfig._cubeVizVisz||{};if("true"==this.chartConfig._cubeVizVisz.doSwitchingAxes){var f=p;p=i;i=f}m.initialize(d,g,o);q.hierarchy.clear();q.hierarchy.load(m.getAxesElements(p),"x");q.hierarchy.load(m.getAxesElements(i),"y");if(false===_.str.isBlank(p)&&false===_.str.isBlank(i)){q.handleTwoDimensions(m,p,g,i,c,o)}else{if(false===_.str.isBlank(p)||false===_.str.isBlank(i)){if(false===_.str.isBlank(p)){var j=null;var l=[];var s=m.getAxesElements(p);var n=0;_.each(s,function(t){j=t.observations[_.keys(t.observations)[0]];if(false===_.isNull(c)&&(true===_.isNull(j[c])||true===_.isUndefined(j[c]))){return}q.chartConfig.xAxis.categories.push(q.fetchLabel(t));l.push(j[o])});this.chartConfig.series=[{name:".",data:l}]}else{var j=null;var l=[];var e=m.getAxesElements(i);var n=0;this.chartConfig.xAxis.categories=["."];_.each(e,function(t){j=t.observations[_.keys(t.observations)[0]];if(false===_.isNull(c)&&(true===_.isNull(j[c])||true===_.isUndefined(j[c]))){return}q.chartConfig.series.push({name:q.fetchLabel(t),data:[j[o]]})})}}}q.chartConfig.plotOptions[q.chartConfig.chart.type]={point:{events:{click:chartClickHandler}}};q.configureAxes();return this};b.prototype.configureAxes=function(){this.chartConfig.xAxis.labels={useHTML:true};this.chartConfig.yAxis.labels={useHTML:true}};b.prototype.shouldHideElement=function(f,e){if(this.bottomOnly){return !f||this.hierarchy.getChildren(f).length!=0}var c=null;if(e){c=this.chartConfig.yRoot}else{c=this.chartConfig.xRoot}var d=f.self[this.hierarchy.drillingPredicate];if(!d||typeof d=="string"){return c!=d}else{for(var g in d){if(c==d[g]){return false}}return true}};b.prototype.fetchLabel=function(c){return this.hierarchy.htmlElementLabel(c)};b.prototype.handleTwoDimensions=function(j,m,h,i,d,l){var o=j.getAxesElements(m);var n=this;_.each(o,function(p){if(n.shouldHideElement(p,false)){return}n.chartConfig.xAxis.categories.push(n.fetchLabel(p))});var c=[];_.each(h,function(p){c.push(p["http://purl.org/linked-data/cube#dimension"])});var g={};var f=j.getAxesElements(i);var k="";var e={};n.chartConfig.series=[];_.each(f,function(p){g={color:CubeViz_Visualization_Controller.getColor(p.self.__cv_uri),data:[],name:n.fetchLabel(p)};if(n.shouldHideElement(p,true)){return}_.each(p.observations,function(r){var q=o[r[m]];if(n.shouldHideElement(q,false)){return}k="";_.each(c,function(s){k+=r[s]});if(true===_.isUndefined(e[k])){e[k]=true}else{return}if(false===_.isUndefined(r[l])){g.data.push({y:parseFloat(r[l]),cv_chart:n,xAxisElement:q,seriesElement:p})}else{g.data.push(null)}});if(0==_.size(g.data)){}else{n.chartConfig.series.push(g)}})};b.prototype.rerender=function(){var d=this.currentVisualization;while(d.series[0]){d.series[0].remove(false)}this.updateConfiguration();for(var c in this.chartConfig.series){d.addSeries(this.chartConfig.series[c],false)}d.xAxis[0].setCategories(this.chartConfig.xAxis.categories);d.redraw()};b.prototype.rendered=function(f){this.currentVisualization=f;if(this.hierarchyControls){return}$("#cubeviz-index-legend").before('<div class="hierarchyControls"><div><strong class="hierarchy-drill-by"> Drill by </strong><form><input type="radio" name="drilling" value="x"><span>x-axis</span><input type="radio" name="drilling" value="y"><span>y-axis</span><input type="radio" name="drilling" value="both" checked=true><span>both axes</span></form></div><button type="button">Move Up</button><span class="toggleBottomLevels"><span>Show all bottom levels</span><input type="checkbox"></span></div>');this.hierarchyControls=$("#cubeviz-index-legend").prev()[0];var d=this.hierarchyControls.children[1];var g=this.hierarchyControls.children[2].children[1];var e=this.hierarchyControls.children[0].children[1];var c=this;$(d).click(function(){c.moveUp()});$(e).find("input").change(function(){c.drillType=$(this).val()});$(g).change(function(){if(this.checked){c.setBottomOnly(true)}else{c.setBottomOnly(false)}})};b.prototype.moveUp=function(){if(this.canRollUpX()){var d=this.hierarchy.getParentByUri(this.chartConfig.xRoot);this.chartConfig.xRoot=d?d.self.__cv_uri:null}if(this.canRollUpY()){var c=this.hierarchy.getParentByUri(this.chartConfig.yRoot);this.chartConfig.yRoot=c?c.self.__cv_uri:null}this.rerender();return this};b.prototype.onDestroy=function(){$(this.hierarchyControls).remove()};b.prototype.getCurrentXRoot=function(){return this.chartConfig.xRoot};b.prototype.getCurrentYRoot=function(){return this.chartConfig.yRoot};b.prototype.canDrillX=function(c){return this.hierarchy.getChildren(c).length>0&&(this.drillType=="both"||this.drillType=="x")};b.prototype.canDrillY=function(c){return this.hierarchy.getChildren(c).length>0&&(this.drillType=="both"||this.drillType=="y")};b.prototype.canRollUpX=function(){return(this.drillType=="both"||this.drillType=="x")};b.prototype.canRollUpY=function(){return(this.drillType=="both"||this.drillType=="y")};b.prototype.setBottomOnly=function(c){this.bottomOnly=c;this.rerender()};return b})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Column=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Line=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Pie=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.init=function(e,c,d,f,m,j){if(1<_.size(f)){throw new Error("Pie chart is only suitable for one dimension!");return}var k=f[_.keys(f)[0]]["http://purl.org/linked-data/cube#dimension"];var h="";var g=new DataCube_Observation();var l=this;var o=[];var i=0;this.chartConfig=e;this.chartConfig.colors=[];this.chartConfig.series=[];this.chartConfig.title.text="";if(true===_.isUndefined(this.chartConfig.xAxis)){this.chartConfig.xAxis={title:{text:""}}}if(true===_.isUndefined(this.chartConfig.yAxis)){this.chartConfig.yAxis={title:{text:""}}}g.initialize(c,d,j);var n=g.getAxesElements(k);this.chartConfig.series.push({type:"pie",name:this.chartConfig.title.text,data:[]});_.each(n,function(p){_.each(p.observations,function(q){try{i=parseFloat(q[j])}catch(r){return}if(-1==$.inArray(p.self.__cv_niceLabel,o)){l.chartConfig.series[0].data.push([p.self.__cv_niceLabel,i]);l.chartConfig.colors.push(CubeViz_Visualization_Controller.getColor(p.self.__cv_uri));o.push(p.self.__cv_niceLabel)}else{return}})});return this};return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Polar=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Spline=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);var DataCube_Attribute=(function(){function a(){}a.loadAll=function b(e,c,f,d,g){$.ajax({url:e+"getattributes",data:{modelIri:c,dsdUrl:f,dsUrl:d}}).error(function(j,h,i){throw new Error("Attribute loadAll: "+j.responseText)}).success(function(h){if(false===_.isUndefined(h)&&false===_.isUndefined(h.content)){g(h.content)}})};return a})();var DataCube_Component=(function(){function c(){}c.loadAllDimensions=function b(g,e,h,f,i){$.ajax({url:g+"getcomponents",data:{modelIri:e,dsdUrl:h,dsUrl:f,componentType:"dimension"}}).error(function(l,j,k){throw new Error("loadAllDimensions: "+l.responseText)}).success(function(j){if(false===_.isUndefined(j)&&false===_.isUndefined(j.content)){i(j.content)}})};c.loadAllMeasures=function d(g,e,h,f,i){$.ajax({url:g+"getcomponents",data:{modelIri:e,dsdUrl:h,dsUrl:f,componentType:"measure"}}).error(function(l,j,k){throw new Error("loadAllMeasures: "+l.responseText)}).done(function(j){if(false===_.isUndefined(j)&&false===_.isUndefined(j.content)){i(j.content)}})};c.getDefaultSelectedDimensions=function a(h){var m=[];var h=JSON.parse(JSON.stringify(h));var k=0;var j=0;var e=0;var f=0;var l=0;var n={};var g={};_.each(h,function(o,i){m=[];j=0;f=_.keys(o.__cv_elements).length;e=1+Math.floor(_.keys(o.__cv_elements).length*0.3);e=10<e?10:1>e?1:e;do{l=Math.floor((Math.random()*f));if(-1===$.inArray(l,m)){if((m.length+1)<=e){m.push(l)}if(e==m.length){break}}j++}while((2*e)>j);g={};k=0;_.each(o.__cv_elements,function(p,q){if(-1<$.inArray(k,m)){g[k]=p}k++});o.__cv_elements=g;n[i]=o});return n};return c})();var DataCube_DataSet=(function(){function a(){}a.loadAll=function b(d,c,e,f){$.ajax({url:d+"getdatasets/",data:{dsdUrl:e,modelIri:c}}).error(function(i,g,h){throw new Error("loadAll error: "+i.responseText)}).success(function(g){if(false===_.isUndefined(g)&&false===_.isUndefined(g.content)){f(g.content)}})};return a})();var DataCube_DataStructureDefinition=(function(){function b(){}b.loadAll=function c(d,e,f){$.ajax({url:d+"getdatastructuredefinitions/",data:{m:e}}).error(function(i,g,h){throw new Error("loadAll error: "+i.responseText)}).done(function(g){b.prepareLoadedDataStructureDefinitions(g,f)})};b.prepareLoadedDataStructureDefinitions=function a(d,e){d=JSON.parse(d);d.sort(function(g,f){return g.label.toUpperCase().localeCompare(f.label.toUpperCase())});e(d)};return b})();var DataCube_Observation=(function(){function a(){this._axes={}}a.prototype.addAxisEntryPointsTo=function(e,f,c){var d=this;_.each(c,function(h,g){c[g]={value:h,ref:d._axes[g][h]}});this._axes[e][f].push(c)};a.prototype.getAxesElements=function(c){if(false===_.isUndefined(this._axes[c])){return this._axes[c]}else{return{}}};a.prototype.initialize=function(j,c,g){var i={};var f="";var e={};var d=this;var h=0;this._axes={};_.each(j,function(k){try{h=parseFloat(k[g]);if(true===_.str.include(k[g]," ")){h=parseFloat(k[g].replace(/ /gi,""))}if(true===_.isNaN(h)){return}k[g]=h}catch(l){return}_.each(c,function(m){f=m["http://purl.org/linked-data/cube#dimension"];e=k[f];if(true===_.isUndefined(d._axes[f])){d._axes[f]={}}if(true===_.isUndefined(d._axes[f][e])){i={__cv_uri:e,__cv_niceLabel:e};_.each(m.__cv_elements,function(n){if(n.__cv_uri==e){i=n}});d._axes[f][e]={observations:{},self:i}}d._axes[f][e].observations[k.__cv_uri]=k})});return this};a.loadAll=function b(c,e,d,f){$.ajax({url:d+"getobservations/",data:{cv_dataHash:e,modelIri:c}}).error(function(i,g,h){throw new Error("Observation loadAll error: "+i.responseText)}).done(function(g){f(g.content)})};a.prototype.sortAxis=function(c,d){return this};return a})();var DataCube_Slice=(function(){function a(){}a.loadAll=function b(e,c,f,d,g){$.ajax({url:e+"getslices",data:{modelIri:c,dsdUrl:f,dsUrl:d}}).error(function(j,h,i){throw new Error("DataCube_Slice > loadAll: "+j.responseText)}).success(function(h){if(false===_.isUndefined(h)&&false===_.isUndefined(h.content)){g(h.content)}})};return a})();var DataCube_Hierarchy=(function(){function a(b){if(!b){b="http://www.w3.org/2004/02/skos/core#broader"}this.drillingPredicate=b;this.topNodes={};this.clear()}a.prototype.clear=function(){this.hierarchyTopDown={};this.hierarchyBottomUp={}};a.prototype.load=function(e,d){var c=this;var b=[];_.each(e,function(g){var h=(g.self||g)[c.drillingPredicate];var j=(g.self||g).__cv_uri;if(h&&typeof h=="string"){c.hierarchyBottomUp[j]=e[h];if(!c.hierarchyTopDown[h]){c.hierarchyTopDown[h]={}}c.hierarchyTopDown[h][j]=g}else{if(h){for(var i in h){var f=h[i];c.hierarchyBottomUp[j]=e[f];if(!c.hierarchyTopDown[f]){c.hierarchyTopDown[f]={}}c.hierarchyTopDown[f][j]=g}}else{b.push(j)}}});this.topNodes[d]=b};a.prototype.loadArray=function(d,b){var c={};_.each(d,function(e){var f=(e.self||e).__cv_uri;c[f]=e});this.load(c,b)};a.prototype.getChildren=function(c){if(!c){return[]}var d=[];var b=this.hierarchyTopDown[(c.self||c).__cv_uri];if(!b){b={}}_.each(b,function(e){d.push(e)});return d};a.prototype.getParent=function(b){return this.getParentByUri(b?(b.self||b).__cv_uri:b)};a.prototype.getParentByUri=function(b){if(!b){return null}return this.hierarchyBottomUp[b]};a.prototype.htmlElementLabel=function(b){var d="<div>"+(b.self||b).__cv_niceLabel+"</div>";var e=b;var c;while(c=this.getParent(e)){d="<div>"+(c.self||c).__cv_niceLabel+" &gt; </div>"+d;e=c}return d};a.prototype.stringElementLabel=function(b){var d=(b.self||b).__cv_niceLabel;var e=b;var c;while(c=this.getParent(e)){d=(c.self||c).__cv_niceLabel+" > "+d;e=c}return d};return a})();var View_DataselectionModule_DataSet=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_DataSet",c,d);this.bindGlobalEvents([{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-dataSet-dialog"));return this};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.dataSets);this.render()};a.prototype.onClick_closeAndUpdate=function(h){var f=$(h.target).data("dialogDiv");var e=new CubeViz_Collection("__cv_uri");var g=$("input[name=cubeviz-dataSelectionModule-dataSetRadio]:checked").val();var c=null;var d=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(f);CubeViz_View_Helper.showLeftSidebarSpinner();c=e.addList(this.app._.data.dataSets).get(g);this.app._.data.selectedDS=c;CubeViz_View_Helper.hideCloseAndUpdateSpinner(f);CubeViz_View_Helper.closeDialog(f);$("#cubeviz-dataSet-label").html(_.str.prune(c.__cv_niceLabel,24,".."));this.app._.backend.retrievedObservations={};_.each(this.app._.data.dataStructureDefinitions,function(i){if(i.__cv_uri==c["http://purl.org/linked-data/cube#structure"]){d.app._.data.selectedDSD=i}});this.triggerGlobalEvent("onChange_selectedDS")};a.prototype.onClick_dialogOpener=function(e){var d=$($("#cubeviz-dataSelectionModule-dialog-dataSet").find(".cubeviz-dataSelectionModule-dialogElements").get(0)).children();var c=this;_.each(d,function(f){if(c.app._.data.selectedDS.__cv_uri==$($(f).children().first()).val()){$($(f).children().first()).attr("checked",true)}});CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-dataSet"))};a.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"dataSet",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-dataSet");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_dataSet");$("#cubeviz-dataSet-label").html(_.str.prune(this.app._.data.selectedDS.__cv_niceLabel,24,"..")).attr("title",this.app._.data.selectedDS.__cv_niceLabel);if(1===_.size(this.app._.data.dataSets)){$("#cubeviz-dataSet-dialogOpener").hide()}else{$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogTitle").html(),__cv_hashedUri:"dataSet",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogDescription").html(),__cv_title:""}));var f=$("#cubeviz-dataSelectionModule-dialog-dataSet");CubeViz_View_Helper.attachDialogTo(f,{closeOnEscape:true,showCross:true,width:650});$(f.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-dataSet-dialogOpener").data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",f).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",f).data("type","alphabet");$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var e=new CubeViz_Collection("__cv_uri");var d=null;var c=$(f.find(".cubeviz-dataSelectionModule-dialogElements")[0]);e.addList(this.app._.data.dataSets).sortAscendingBy("__cv_niceLabel").each(function(g){d=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:g.__cv_niceLabel,__cv_uri:g.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-dataSetRadio",radioName:"cubeviz-dataSelectionModule-dataSetRadio",radioValue:g.__cv_uri}));c.append(d)});this.bindUserInterfaceEvents({"click #cubeviz-dataSet-dialogOpener":this.onClick_dialogOpener});$("#cubeviz-dataSet-dialogOpener").show()}this.triggerGlobalEvent("onAfterRender_dataSet");this.bindUserInterfaceEvents({"click #cubeviz-dataSet-questionmark":this.onClick_questionmark});return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Slice=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_Slice",c,d);this.bindGlobalEvents([{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.slices);this.render()};a.prototype.onChange_selectedDS=function(){var c=this;DataCube_Slice.loadAll(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(d){c.app._.data.slices=d;if(0===_.keys(d).length){}else{c.app._.data.selectedSlice={}}})};a.prototype.onClick_closeAndUpdate=function(f){var e=$(f.target).data("dialogDiv");var g=new CubeViz_Collection("__cv_uri");var c=$("input[name=cubeviz-dataSelectionModule-sliceRadio]:checked").val();var d=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(e);if("noSlice"==c){this.app._.data.selectedSlice={};$("#cubeviz-slice-label").html(_.str.prune($("#cubeviz-dataSelectionModule-tra-sliceNoSelection").html(),24,".."))}else{this.app._.data.selectedSlice=g.addList(this.app._.data.slices).get(c);$("#cubeviz-slice-label").html(_.str.prune(this.app._.data.selectedSlice.__cv_niceLabel,24,".."))}CubeViz_View_Helper.hideCloseAndUpdateSpinner(e);CubeViz_View_Helper.closeDialog(e);this.triggerGlobalEvent("onChange_selectedSlice")};a.prototype.onClick_dialogOpener=function(c){CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-slice"))};a.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"slice",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-sliceHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-sliceHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-slice");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_slice");var d="";var h="";var c=this;if(0===_.size(this.app._.data.slices)){$("#cubeviz-dataSelectionModule-sliceBlock").hide()}else{$("#cubeviz-dataSelectionModule-sliceBlock").show();if(0===_.keys(this.app._.data.selectedSlice).length){d=$("#cubeviz-dataSelectionModule-tra-sliceNoSelection").html()}else{d=this.app._.data.selectedComponents.attribute.__cv_niceLabel;h=this.app._.data.selectedComponents.attribute.__cv_description}$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-sliceDialogTitle").html(),__cv_hashedUri:"slice",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-sliceDialogDescription").html(),__cv_title:""}));var g=$("#cubeviz-dataSelectionModule-dialog-slice");CubeViz_View_Helper.attachDialogTo(g,{closeOnEscape:true,showCross:true,width:650});$(g.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(g.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(g.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-slice-dialogOpener").data("dialogDiv",g);$($(g.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",g);$($(g.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",g).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(g.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",g).data("type","alphabet");$($(g.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(g.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var f=null;var e=$(g.find(".cubeviz-dataSelectionModule-dialogElements")[0]);f=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-sliceDialogNoSliceSelectionElement").html(),__cv_uri:"__cv_noSlice",radioCSSClass:"cubeviz-dataSelectionModule-sliceRadio",radioName:"cubeviz-dataSelectionModule-sliceRadio",radioValue:"noSlice"}));if(0===_.size(this.app._.data.selectedSlice)){$(f.children().first()).attr("checked",true)}$(f.children().last()).css("font-weight","bold");e.append(f);this.collection.sortAscendingBy("__cv_niceLabel").each(function(i){f=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:i.__cv_niceLabel,__cv_uri:i.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-sliceRadio",radioName:"cubeviz-dataSelectionModule-sliceRadio",radioValue:i.__cv_uri}));if(i.__cv_uri==c.app._.data.selectedSlice.__cv_uri){$(f.children().first()).attr("checked",true)}e.append(f)});this.bindUserInterfaceEvents({"click #cubeviz-slice-dialogOpener":this.onClick_dialogOpener})}$("#cubeviz-slice-label").html(_.str.prune(d,24,"..")).attr("title",d);$("#cubeviz-slice-description").html(_.str.prune(h,55,"..")).attr("title",h);this.triggerGlobalEvent("onAfterRender_slice");this.bindUserInterfaceEvents({"click #cubeviz-slice-questionmark":this.onClick_questionmark});return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Measure=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_Measure",c,d);this.bindGlobalEvents([{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-measure-dialog"));return this};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.components.measures);this.render()};a.prototype.onChange_selectedDS=function(d){var c=this;DataCube_Component.loadAllMeasures(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(e){c.app._.data.components.measures=e;if(0===_.keys(e).length){throw new Error("Error: There are no measures in the selected data set!")}else{c.app._.data.selectedComponents.measure=e[_.keys(e)[0]]}})};a.prototype.onClick_closeAndUpdate=function(g){var f=$(g.target).data("dialogDiv");var h=new CubeViz_Collection("__cv_uri");var e=$("input[name=cubeviz-dataSelectionModule-measureRadio]:checked").val();var c=null;var d=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(f);CubeViz_View_Helper.showLeftSidebarSpinner();c=h.addList(this.app._.data.components.measures).get(e);this.app._.data.selectedComponents.measure=c;CubeViz_View_Helper.hideCloseAndUpdateSpinner(f);CubeViz_View_Helper.closeDialog(f);$("#cubeviz-measure-label").html(_.str.prune(c.__cv_niceLabel,24,".."));this.triggerGlobalEvent("onChange_selectedMeasure");CubeViz_View_Helper.hideLeftSidebarSpinner()};a.prototype.onClick_dialogOpener=function(e){var d=$($("#cubeviz-dataSelectionModule-dialog-measure").find(".cubeviz-dataSelectionModule-dialogElements").get(0)).children();var c=this;if(1==d.length){$($(d.first()).children().first()).attr("checked",true)}else{_.each(d,function(f){if(c.app._.data.selectedComponents.measure.__cv_uri==$($(f).children().first()).val()){$($(f).children().first()).attr("checked",true)}})}CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-measure"))};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_measure");$("#cubeviz-measure-label").html(_.str.prune(this.app._.data.selectedComponents.measure.__cv_niceLabel,24,"..")).attr("title",this.app._.data.selectedComponents.measure.__cv_niceLabel);$("#cubeviz-measure-description").html(_.str.prune(this.app._.data.selectedComponents.measure.__cv_description,55,"..")).attr("title",this.app._.data.selectedComponents.measure.__cv_description);if(1==_.keys(this.app._.data.components.measures).length){$("#cubeviz-measure-dialogOpener").hide()}else{$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-measureDialogTitle").html(),__cv_hashedUri:"measure",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-measureDialogDescription").html(),__cv_title:""}));var e=$("#cubeviz-dataSelectionModule-dialog-measure");CubeViz_View_Helper.attachDialogTo(e,{closeOnEscape:true,showCross:true,width:650});$(e.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide();$(e.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(e.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(e.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-measure-dialogOpener").data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",e).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",e).data("type","alphabet");$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var f=new CubeViz_Collection("__cv_uri");var d=null;var c=$(e.find(".cubeviz-dataSelectionModule-dialogElements")[0]);f.addList(this.app._.data.components.measures).sortAscendingBy("__cv_niceLabel").each(function(g){d=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:g.__cv_niceLabel,__cv_uri:g.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-measureRadio",radioName:"cubeviz-dataSelectionModule-measureRadio",radioValue:g.__cv_uri}));c.append(d)});this.bindUserInterfaceEvents({"click #cubeviz-measure-dialogOpener":this.onClick_dialogOpener})}this.triggerGlobalEvent("onAfterRender_measure");return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Attribute=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CubeVizModule_Attribute",c,d);this.bindGlobalEvents([{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application}])}b.prototype.destroy=function(){a.prototype.destroy.call(this);$("#cubeviz-attribute-dialogOpener").off();CubeViz_View_Helper.destroyDialog($("#cubeviz-dataSelectionModule-dialog-attribute"));$("#cubeviz-dataSelectionModule-dialog-attribute").remove();return this};b.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.components.attributes);this.render()};b.prototype.onChange_selectedDS=function(d){var c=this;DataCube_Attribute.loadAll(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(e){c.app._.data.components.attributes=e;if(0===_.keys(e).length){}else{c.app._.data.selectedComponents.attribute=e[_.keys(e)[0]]}c.destroy().initialize()})};b.prototype.onClick_closeAndUpdate=function(h){var g=$(h.target).data("dialogDiv");var f=new CubeViz_Collection("__cv_uri");var c=$("input[name=cubeviz-dataSelectionModule-attributeRadio]:checked").val();var d=null;var e=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(g);CubeViz_View_Helper.showLeftSidebarSpinner();d=f.addList(this.app._.data.components.attributes).get(c);this.app._.data.selectedComponents.attribute=d;CubeViz_View_Helper.hideCloseAndUpdateSpinner(g);CubeViz_View_Helper.closeDialog(g);$("#cubeviz-attribute-label").html(_.str.prune(d.__cv_niceLabel,24,".."));this.triggerGlobalEvent("onChange_selectedAttribute");CubeViz_View_Helper.hideLeftSidebarSpinner()};b.prototype.onClick_dialogOpener=function(e){var d=$($("#cubeviz-dataSelectionModule-dialog-attribute").find(".cubeviz-dataSelectionModule-dialogElements").get(0)).children();var c=this;if(1==d.length){$($(d.first()).children().first()).attr("checked",true)}else{_.each(d,function(f){if(c.app._.data.selectedComponents.attribute.__cv_uri==$($(f).children().first()).val()){$($(f).children().first()).attr("checked",true)}})}CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-attribute"))};b.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"attributeAndMeasure",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-attributeAndMeasureHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-attributeAndMeasureHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-attributeAndMeasure");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_attribute");var i=false;var c="";var g="";if(true===_.isUndefined(this.app._.data.selectedComponents.attribute)||true===_.isNull(this.app._.data.selectedComponents.attribute)){c="[no attribute found]";i=true;$("#cubeviz-dataSelectionModule-attributeBlock").hide()}else{c=this.app._.data.selectedComponents.attribute.__cv_niceLabel;g=this.app._.data.selectedComponents.attribute.__cv_description}$("#cubeviz-attribute-label").html(_.str.prune(c,24,"..")).attr("title",c);$("#cubeviz-attribute-description").html(_.str.prune(g,55,"..")).attr("title",g);if(false===i){if(1==_.size(this.app._.data.components.attributes)){$("#cubeviz-attribute-dialogOpener").hide()}else{$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-attributeDialogTitle").html(),__cv_hashedUri:"attribute",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-attributeDialogDescription").html(),__cv_title:""}));var f=$("#cubeviz-dataSelectionModule-dialog-attribute");CubeViz_View_Helper.attachDialogTo(f,{closeOnEscape:true,showCross:true,width:650});$(f.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-attribute-dialogOpener").data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",f).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",f).data("type","alphabet");$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var h=new CubeViz_Collection("__cv_uri");var e=null;var d=$(f.find(".cubeviz-dataSelectionModule-dialogElements")[0]);h.addList(this.app._.data.components.attributes).sortAscendingBy("__cv_niceLabel").each(function(j){e=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:j.__cv_niceLabel,__cv_uri:j.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-attributeRadio",radioName:"cubeviz-dataSelectionModule-attributeRadio",radioValue:j.__cv_uri}));d.append(e)});this.bindUserInterfaceEvents({"click #cubeviz-attribute-dialogOpener":this.onClick_dialogOpener});$("#cubeviz-attribute-dialogOpener").show()}}else{$("#cubeviz-attribute-dialogOpener").hide()}this.triggerGlobalEvent("onAfterRender_attribute");this.bindUserInterfaceEvents({"click #cubeviz-attributeAndMeasure-questionmark":this.onClick_questionmark});return this};return b})(CubeViz_View_Abstract);var View_DataselectionModule_Component=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_Component",c,d);this.bindGlobalEvents([{name:"onStart_application",handler:this.onStart_application},{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onChange_selectedSlice",handler:this.onChange_selectedSlice}])}a.prototype.configureSetupComponentDialog=function(d,g,f){var c=this;$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:d.__cv_niceLabel,__cv_hashedUri:d.__cv_hashedUri,__cv_description:d.__cv_description,__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-componentDialogDescription").html(),__cv_title:$("#cubeviz-dataSelectionModule-tra-componentDialogMainTitle").html()}));var e=$("#cubeviz-dataSelectionModule-dialog-"+d.__cv_hashedUri);if(true==_.str.isBlank(d.__cv_description)){$(e.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide()}e.data("componentBox",g).data("component",d);CubeViz_View_Helper.attachDialogTo(e);$(e.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).data("dialogDiv",e);$(e.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).data("dialogDiv",e);f.data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",e).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",e).data("type","alphabet");$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).data("dialogDiv",e).data("type","check status");$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).data("dialogDiv",e).data("type","observation count");this.configureSetupComponentElements(d)};a.prototype.configureSetupComponentElements=function(l){var f=null;var k=$("#cubeviz-dataSelectionModule-dialog-"+l.__cv_hashedUri);var j={};var h=new CubeViz_Collection("__cv_uri");var g=$(k.find(".cubeviz-dataSelectionModule-dialogElements")[0]);var e=this.app._.data.selectedComponents.dimensions[l.__cv_uri].__cv_elements;var m=this;var d=null;var c=false;var i=new DataCube_Hierarchy();i.loadArray(l.__cv_elements,"elements");h.addList(l.__cv_elements).sortAscendingBy("__cv_niceLabel").each(function(n){d=undefined!==_.find(e,function(o){return false===_.isUndefined(o)?o.__cv_uri==n.__cv_uri:false});if(true===d){c=true}j=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogCheckboxElement").html(),{__cv_niceLabel:i.htmlElementLabel(n),__cv_uri:n.__cv_uri,__cv_uri2:n.__cv_uri}));f=j.children().first();if(true==d){f.attr("checked",true)}$(f).on("click",$.proxy(m.onClick_dimensionElementCheckbox,m));j.data("data",n).data("dialogDiv",k);g.append(j)})};a.prototype.destroy=function(){_.each(this.collection._,function(c){$("#cubeviz-dataSelectionModule-dialog-"+c.__cv_hashedUri).dialog("destroy");$("#cubeviz-dataSelectionModule-dialog-"+c.__cv_hashedUri).remove()});b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-component-dialog"));return this};a.prototype.initialize=function(){this.collection.reset("__cv_hashedUri");this.collection.addList(this.app._.data.components.dimensions);this.render()};a.prototype.loadComponentDimensions=function(d){var c=this;DataCube_Component.loadAllDimensions(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(e){c.app._.data.components.dimensions=e;c.app._.data.selectedComponents.dimensions=DataCube_Component.getDefaultSelectedDimensions(e);c.collection.reset("__cv_hashedUri").addList(e);d()})};a.prototype.onChange_selectedDS=function(d,e){var c=this;this.destroy();this.loadComponentDimensions(function(){CubeViz_ConfigurationLink.save(c.app._.backend.url,c.app._.data,"data",function(f){c.app._.backend.dataHash=f;c.render();CubeViz_View_Helper.hideLeftSidebarSpinner()})})};a.prototype.onChange_selectedSlice=function(g){if(0===_.size(this.app._.data.selectedSlice)){}else{var h=null;var f=null;var e="";var c="";var d=this;_.each(this.app._.data.components.dimensions,function(i){e=i["http://purl.org/linked-data/cube#dimension"];c=d.app._.data.selectedSlice[e];if(false===_.str.isBlank(c)){_.each(i.__cv_elements,function(j){if(j.__cv_uri==c){d.app._.data.selectedComponents.dimensions[i.__cv_uri].__cv_elements={0:j}}})}});this.app._.data.numberOfMultipleDimensions=_.size(CubeViz_Visualization_Controller.getMultipleDimensions(this.app._.data.selectedComponents.dimensions));this.app._.data.numberOfOneElementDimensions=_.size(CubeViz_Visualization_Controller.getOneElementDimensions(this.app._.data.selectedComponents.dimensions));this.destroy().initialize()}};a.prototype.onClick_cancel=function(c){CubeViz_View_Helper.closeDialog($(c.target).data("dialogDiv"))};a.prototype.onClick_dimensionElementCheckbox=function(e){var f=$(e.target);var h=$($(e.target).parent());var d=h.data("dialogDiv").find('[type="checkbox"]');var c=false;var g=$(h.data("dialogDiv")).data("component").__cv_selectedElementCount;if(1<g||1==this.app._.data.numberOfMultipleDimensions){return}_.each(d,function(i){if($(i).attr("checked")){c=true}});if(false==c){_.each(d,function(i){$(i).attr("disabled",false)});$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).attr("disabled",false).removeClass("ui-state-disabled");$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).attr("disabled",false).removeClass("ui-state-disabled")}else{_.each(d,function(i){if(!$(i).attr("checked")){$(i).attr("disabled",true)}});$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).attr("disabled",true).addClass("ui-state-disabled");$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).attr("disabled",true).addClass("ui-state-disabled")}};a.prototype.onClick_closeAndUpdate=function(e){var d=$(e.target).data("dialogDiv");var c=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(d);this.readAndSaveSetupComponentDialogChanges(d,function(){if(true===cubeVizApp._.backend.uiParts.index.isLoaded){c.triggerGlobalEvent("onReRender_visualization")}c.triggerGlobalEvent("onUpdate_componentDimensions");CubeViz_View_Helper.hideCloseAndUpdateSpinner(d);CubeViz_View_Helper.closeDialog(d)})};a.prototype.onClick_deselectButton=function(c){if("false"==$(c.target).attr("disabled")||true===_.isUndefined($(c.target).attr("disabled"))){$(c.target).data("dialogDiv").find('[type="checkbox"]').attr("checked",false)}};a.prototype.onClick_selectAllButton=function(c){if("false"==$(c.target).attr("disabled")||true===_.isUndefined($(c.target).attr("disabled"))){$(c.target).data("dialogDiv").find('[type="checkbox"]').attr("checked",true)}};a.prototype.onClick_setupComponentOpener=function(c){this.triggerGlobalEvent("onClick_setupComponentOpener");var e=$($(c.target).data("dialogDiv")).data("component").__cv_selectedElementCount;var d=$(c.target).data("dialogDiv").find('[type="checkbox"]');if(1==e&&2==this.app._.data.numberOfMultipleDimensions&&2<_.size(this.app._.data.components.dimensions)){_.each(d,function(f){if(!$(f).attr("checked")){$(f).attr("disabled",true)}});$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).attr("disabled",true).addClass("ui-state-disabled");$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).attr("disabled",true).addClass("ui-state-disabled")}else{_.each(d,function(f){$(f).attr("disabled",false)});$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).attr("disabled",false).removeClass("ui-state-disabled");$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).attr("disabled",false).removeClass("ui-state-disabled")}CubeViz_View_Helper.openDialog($(c.target).data("dialogDiv"))};a.prototype.onClick_sortButton=function(e){var d=$(e.target).data("dialogDiv");if(true===_.isUndefined(d)){return}var h=d.data("dimensionTypeUrl");var g=$(d.find(".cubeviz-dataSelectionModule-dialogElements").first());var f=g.children("li");var c=[];$(e.target).data("dialogDiv").find(".cubeviz-component-sortButton").removeClass("cubeviz-dataSelectionModule-dialogSortButtonSelected");$(e.target).addClass("cubeviz-dataSelectionModule-dialogSortButtonSelected");switch($(e.target).data("type")){case"alphabet":c=CubeViz_View_Helper.sortLiItemsByAlphabet(f);break;case"check status":c=CubeViz_View_Helper.sortLiItemsByCheckStatus(f);break;case"observation count":c=CubeViz_View_Helper.sortLiItemsByObservationCount(f,h,this.app._.backend.retrievedObservations);break;default:return}g.empty();_.each(c,function(i){g.append(i)})};a.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"component",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-componentHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-componentHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-component");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};a.prototype.readAndSaveSetupComponentDialogChanges=function(g,j){var f=g.find(".cubeviz-dataSelectionModule-dialogElements").children();var c=g.data("componentBox");var h=g.data("component");var i=null;var d=null;var e=new CubeViz_Collection("__cv_uri");var k=this;if(undefined===h){return}_.each(f,function(l){i=$($(l).children().get(0));d=$($(l).children().get(1));if("checked"===i.attr("checked")){e.add($(l).data("data"))}});this.app._.data.selectedComponents.dimensions[h.__cv_uri].__cv_elements=e.toObject();$(c.find(".cubeviz-component-selectedCount").get(0)).html(e.size());g.data("component").__cv_selectedElementCount=e.size();this.app._.data.numberOfMultipleDimensions=_.size(CubeViz_Visualization_Controller.getMultipleDimensions(this.app._.data.selectedComponents.dimensions));this.app._.data.numberOfOneElementDimensions=_.size(CubeViz_Visualization_Controller.getOneElementDimensions(this.app._.data.selectedComponents.dimensions));CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.data,"data",function(l){DataCube_Observation.loadAll(k.app._.backend.modelUrl,l,k.app._.backend.url,function(m){k.app._.backend.retrievedObservations=m;j()});k.app._.backend.dataHash=l})};a.prototype.onComplete_loadDS=function(c,d){this.onChange_selectedDS(c,d)};a.prototype.onComplete_loadObservations=function(d,c){this.app._.backend.retrievedObservations=c};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_component");var e=this.collection._;var h=$("#cubviz-component-listBox");var i=null;var c=this.app._.data.selectedComponents.dimensions;var f=null;var d=this;var g=null;this.collection.reset();_.each(e,function(j){if(false===_.isUndefined(c)){f=c[j.__cv_uri];j.__cv_selectedElementCount=_.keys(f.__cv_elements).length}else{j.__cv_selectedElementCount=1}j.__cv_elementCount=_.size(j.__cv_elements);j.__cv_shortLabel=_.str.prune(j.__cv_niceLabel,23,"..");j.__cv_shortDescription=_.str.prune(j.__cv_description,38,"..");i=$(CubeViz_View_Helper.tplReplace($("#cubeviz-component-tpl-listBoxItem").html(),j));if(1===j.__cv_elementCount){$(i.find(".cubeviz-component-setupComponentOpener").get(0)).hide();$(i.find(".cubeviz-component-selectedElementsBlock").get(0)).hide()}$(i.find(".cubeviz-component-setupComponentOpener").get(0)).data("dimension",j);h.append(i);d.configureSetupComponentDialog(j,i,$(i.find(".cubeviz-component-setupComponentOpener").get(0)));$(i.find(".cubeviz-component-selectedCount").get(0)).html(j.__cv_selectedElementCount);d.collection.add(j)});this.bindUserInterfaceEvents({"click .cubeviz-component-setupComponentOpener":this.onClick_setupComponentOpener,"click #cubeviz-component-questionmark":this.onClick_questionmark,"click .cubeviz-dataSelectionModule-cancelBtn":this.onClick_cancel,"click .cubeviz-dataSelectionModule-deselectButton":this.onClick_deselectButton,"click .cubeviz-dataSelectionModule-selectAllButton":this.onClick_selectAllButton,"click .cubeviz-dataSelectionModule-dialogSortButtons":this.onClick_sortButton});this.triggerGlobalEvent("onAfterRender_component");return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Footer=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CubeVizModule_Footer",c,d);this.bindGlobalEvents([{name:"onAfterChange_selectedDSD",handler:this.onAfterChange_selectedDSD},{name:"onBeforeClick_selectorItem",handler:this.onBeforeClick_selectorItem},{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application},{name:"onUpdate_componentDimensions",handler:this.onUpdate_componentDimensions}])}b.prototype.changePermaLinkButton=function(){var c="";if(true==_.isUndefined(this.collection.get("buttonVal"))){this.collection.add({id:"buttonVal",value:$("#cubeviz-footer-permaLinkButton").html()});this.showLink("<")}else{c=this.collection.get("buttonVal").value;this.collection.remove("buttonVal");this.closeLink(c)}};b.prototype.closeLink=function(c){$("#cubeviz-footer-permaLinkButton").fadeOut("slow");$("#cubeviz-footer-permaLinkMenu").fadeOut("slow",function(){$("#cubeviz-footer-permaLinkButton").html(c).show()})};b.prototype.initialize=function(){this.collection.add({id:"cubeviz-footer-permaLink",html:$("#cubeviz-footer-permaLink").html()});this.render()};b.prototype.onAfterChange_selectedDSD=function(){if(false===_.isUndefined(this.collection.get("buttonVal"))){this.changePermaLinkButton()}};b.prototype.onBeforeClick_selectorItem=function(){if(true==_.isUndefined(this.collection.get("buttonVal"))){}else{var c=this.collection.get("buttonVal").value;this.collection.remove("buttonVal");this.closeLink(c)}};b.prototype.onChange_selectedDS=function(){this.onAfterChange_selectedDSD()};b.prototype.onClick_permaLinkButton=function(c){this.changePermaLinkButton()};b.prototype.onClick_showVisualization=function(d){var c=this;if(true===cubeVizApp._.backend.uiParts.index.isLoaded){CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.data,"data",function(e){DataCube_Observation.loadAll(c.app._.backend.modelUrl,e,c.app._.backend.url,function(f){c.app._.backend.retrievedObservations=f;c.triggerGlobalEvent("onReRender_visualization")});c.app._.backend.dataHash=e})}else{if(false===cubeVizApp._.backend.uiParts.index.isLoaded){CubeViz_ConfigurationLink.save(c.app._.backend.url,c.app._.data,"data",function(e){window.location.href=c.app._.backend.url+"?m="+encodeURIComponent(c.app._.backend.modelUrl)+"&cv_dataHash="+e+"&cv_uiHash="+c.app._.backend.uiHash})}else{CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.data,"data",function(e){window.location.href=c.app._.backend.url+"?m="+encodeURIComponent(c.app._.backend.modelUrl)+"&cv_dataHash="+e+"&cv_uiHash="+c.app._.backend.uiHash})}}};b.prototype.onStart_application=function(){this.initialize()};b.prototype.onUpdate_componentDimensions=function(){if(true==_.isUndefined(this.collection.get("buttonVal"))){}else{var c=this.collection.get("buttonVal").value;this.collection.remove("buttonVal");this.closeLink(c)}};b.prototype.render=function(){this.bindUserInterfaceEvents({"click #cubeviz-footer-permaLinkButton":this.onClick_permaLinkButton,"click #cubeviz-footer-showVisualizationButton":this.onClick_showVisualization});return this};b.prototype.showLink=function(d){var c=this;$("#cubeviz-footer-permaLinkButton").fadeOut("slow",function(){$("#cubeviz-footer-permaLinkButton").html(d).fadeIn("slow");var f=c.app._.backend.url+"?m="+encodeURIComponent(c.app._.backend.modelUrl)+"&cv_dataHash="+c.app._.backend.dataHash+"&cv_uiHash="+c.app._.backend.uiHash;var e=$("<a></a>").attr("href",f).attr("target","_self").html(c.collection.get("cubeviz-footer-permaLink").html);$("#cubeviz-footer-permaLink").html(e).fadeIn("slow");$("#cubeviz-footer-permaLinkMenu").fadeIn("slow")})};return b})(CubeViz_View_Abstract);var View_IndexAction_ExportArea=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_IndexAction_ExportArea",c,d);this.bindGlobalEvents([{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application},{name:"onUpdate_componentDimensions",handler:this.onUpdate_componentDimensions}])}b.prototype.destroy=function(){a.prototype.destroy.call(this);return this};b.prototype.initialize=function(){this.render()};b.prototype.onReRender_visualization=function(){this.initialize()};b.prototype.onStart_application=function(){this.initialize()};b.prototype.onUpdate_componentDimensions=function(){this.initialize()};b.prototype.render=function(){this.setUrlToDownload();return this};b.prototype.setUrlToDownload=function(){var c=this.app._.backend.url+"exportdataselection/?";c+="dataHash="+this.app._.backend.dataHash;$("#cubeviz-index-exportArea-btnTurtle").attr("href",c+"&type=turtle");$("#cubeviz-index-exportArea-btnCsv").attr("href",c+"&type=csv")};return b})(CubeViz_View_Abstract);var View_IndexAction_Header=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_IndexAction_Header",c,d);this.bindGlobalEvents([{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-index-headerDialogBox"));return this};a.prototype.initialize=function(){this.render()};a.prototype.onClick_questionMark=function(){$("#cubeviz-index-headerDialogBox").dialog("open")};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){CubeViz_View_Helper.attachDialogTo($("#cubeviz-index-headerDialogBox"),{closeOnEscape:true,height:450,showCross:true,width:"50%"});this.renderHeader();this.renderDialogBox();this.bindUserInterfaceEvents({"click #cubeviz-index-headerQuestionMarkHeadline":this.onClick_questionMark});return this};a.prototype.renderDialogBox=function(){var d="";if(false===_.isUndefined(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])&&false===_.str.isBlank(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])){d=this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"].content}else{d=this.app._.backend.modelUrl}$("#cubeviz-index-headerDialogBox").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerDialogBoxHead").html(),{label:d}));var c=$($("#cubeviz-index-headerDialogBox").children().last());_.each(this.app._.backend.modelInformation,function(e){c.append(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerDialogBoxEntry").html(),{predicateLabel:e.predicateLabel,objectContent:CubeViz_Visualization_Controller.linkify(e.content)}))})};a.prototype.renderHeader=function(){var c;if(false===_.isUndefined(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])&&false===_.str.isBlank(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])){c=this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"].content}else{c=this.app._.backend.modelUrl}$("#cubeviz-index-header").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-header").html(),{modelLabel:c}))};return a})(CubeViz_View_Abstract);var View_IndexAction_Legend=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_IndexAction_Legend",c,d);this.bindGlobalEvents([{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application}])}b.prototype.destroy=function(){$("#cubeviz-legend-btnShowRetrievedObservations").off();$("#cubeviz-legend-sortByTitle").off();$("#cubeviz-legend-sortByValue").off();$("#cubeviz-legend-retrievedObservations").slideUp("slow");$("#cubeviz-legend-selectedConfiguration").slideUp("slow");$("#cubeviz-legend-dataSet").html("");$("#cubeviz-legend-observations").html("");$("#cubeviz-legend-configurationList").html("");CubeViz_View_Helper.destroyDialog($("#cubeviz-legend-componentDimensionInfoDialog"));a.prototype.destroy.call(this);return this};b.prototype.displayDsdAndDs=function(d,f,e,c){$("#cubeviz-legend-dsdAndDs").html(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-dsdAndDs").html(),{dsdLabel:d,dsdUrl:f,dsLabel:e,dsUrl:c}))};b.prototype.displayRetrievedObservations=function(e){var d=null;var c="";$("#cubeviz-legend-observations").html("");_.each(e,function(f){$("#cubeviz-legend-observations").append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-observation").html(),f));d=$($("#cubeviz-legend-observations").find(".cubeviz-legend-observationInfoList").last());_.each(f.__cv_elements,function(g){d.append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-observationInfoListEntry").html(),{dimensionLabel:g.dimensionLabel,fullLabel:g.__cv_niceLabel,__cv_shortLabel:_.str.prune(g.__cv_niceLabel,65,"..."),__cv_uri:g.__cv_uri}))})})};b.prototype.displaySelectedConfiguration=function(d){var i=null;var e=null;var h=null;var c=new CubeViz_Collection("__cv_uri");var g="";var f="";$("#cubeviz-legend-components").html($("#cubeviz-legend-tpl-componentList").html());_.each(d,function(j){$("#cubeviz-legend-componentList").append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-componentDimension").html(),{__cv_niceLabel:j.__cv_niceLabel}));h=$($("#cubeviz-legend-componentList").find(".cubeviz-legend-componentDimensionList").last());g="";c.reset().addList(JSON.parse(JSON.stringify(j.__cv_elements))).sortAscendingBy().each(function(k){h.append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-componentDimensionEntry").html(),{fullLabel:k.__cv_niceLabel,__cv_shortLabel:_.str.prune(k.__cv_niceLabel,75," ..."),__cv_uri:k.__cv_uri}));e=$(h.find(".cubeviz-legend-observationIcon").last());i=$(h.find(".cubeviz-legend-componentDimensionInfoArea").last());$(h.find(".cubeviz-legend-componentDimensionShowInfo").last()).data("componentDimensionInfoArea",i).data("dimension",j).data("dimensionElement",k).data("observationIcon",e)})})};b.prototype.generateList=function(c,e,h){var j="http://purl.org/linked-data/cube#dimension";var i="";var d=[];var f="";var i="";var g="http://www.w3.org/2000/01/rdf-schema#label";var k=[];_.each(c,function(l){d=[];_.each(e,function(m){_.each(m.__cv_elements,function(n){if(n.__cv_uri==l[m[j]]){d.push({dimensionLabel:m.__cv_niceLabel,__cv_niceLabel:n.__cv_niceLabel,__cv_uri:n.__cv_uri})}})});k.push({__cv_niceLabel:l.__cv_niceLabel,__cv_value:l[h],__cv_uri:l.__cv_uri,__cv_elements:d})});return k};b.prototype.initialize=function(){this.render()};b.prototype.onClick_btnShowSelectedConfiguration=function(c){c.preventDefault();$("#cubeviz-legend-selectedConfiguration").slideToggle("slow");return false};b.prototype.onClick_btnShowRetrievedObservations=function(c){c.preventDefault();$("#cubeviz-legend-retrievedObservations").slideToggle("slow");return false};b.prototype.onClick_componentDimensionShowInfo=function(f){f.preventDefault();var e=$(f.target);var h=e.data("dimension");var g=e.data("dimensionElement");var c=e.data("observationIcon");var d=$($("#cubeviz-legend-tpl-componentDimensionInfoList").html());_.each(g,function(j,i){if(false===_.str.startsWith(i,"__cv_")){d.append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-componentDimensionInfoListEntry").html(),{key:i,value:CubeViz_Visualization_Controller.linkify(j)}))}});$("#cubeviz-legend-componentDimensionInfoDialog").html("").append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-componentDimensionInfoHeader").html(),g)).append(d).fadeIn("slow");$("#cubeviz-legend-componentDimensionInfoDialog").dialog("open");return false};b.prototype.onClick_sortByTitle=function(){this.collection.sortAscendingBy("__cv_niceLabel");this.displayRetrievedObservations(this.collection._)};b.prototype.onClick_sortByValue=function(){this.collection.sortAscendingBy("__cv_value");this.displayRetrievedObservations(this.collection._)};b.prototype.onReRender_visualization=function(){this.destroy();this.initialize()};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){var d=this.app._.data.selectedComponents.measure["http://purl.org/linked-data/cube#measure"];var c=this;this.displayDsdAndDs(this.app._.data.selectedDSD.__cv_niceLabel,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_niceLabel,this.app._.data.selectedDS.__cv_uri);this.displaySelectedConfiguration(this.app._.data.selectedComponents.dimensions);this.collection.reset("__cv_niceLabel").addList(this.generateList(this.app._.backend.retrievedObservations,this.app._.data.selectedComponents.dimensions,d));this.collection.sortAscendingBy("__cv_niceLabel");this.displayRetrievedObservations(this.collection._);CubeViz_View_Helper.attachDialogTo($("#cubeviz-legend-componentDimensionInfoDialog"),{closeOnEscape:true,showCross:true,height:450,width:"50%"});$("#cubeviz-legend-btnShowRetrievedObservations").off();$("#cubeviz-legend-btnShowSelectedConfiguration").off();$(".cubeviz-legend-componentDimensionShowInfo").off();$("#cubeviz-legend-sortByTitle").off();$("#cubeviz-legend-sortByValue").off();this.bindUserInterfaceEvents({"click #cubeviz-legend-btnShowSelectedConfiguration":this.onClick_btnShowSelectedConfiguration,"click #cubeviz-legend-btnShowRetrievedObservations":this.onClick_btnShowRetrievedObservations,"click .cubeviz-legend-componentDimensionShowInfo":this.onClick_componentDimensionShowInfo,"click #cubeviz-legend-sortByTitle":this.onClick_sortByTitle,"click #cubeviz-legend-sortByValue":this.onClick_sortByValue});return this};return b})(CubeViz_View_Abstract);var View_IndexAction_Visualization=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_IndexAction_Visualization",c,d);this.bindGlobalEvents([{name:"onChange_visualizationClass",handler:this.onChange_visualizationClass},{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.handleException=function(c){this.setVisualizationHeight();if(true===_.str.include(c,"Highcharts error #10")){$("#cubeviz-index-visualization").html($("#cubeviz-visualization-tpl-notificationHightchartsException10").html())}else{if(true===_.str.include(c,"CubeViz error no observations retrieved")){$("#cubeviz-index-visualization").html($("#cubeviz-visualization-tpl-nothingFoundNotification").text());this.triggerGlobalEvent("onReceived_noData")}else{if(true===_.str.include(c,"CubeViz error no elements to visualize")){$("#cubeviz-index-visualization").html("CubeViz error no elements to visualize");this.triggerGlobalEvent("onVisualize_noElements")}}}if(false===_.isUndefined(console)&&false===_.isUndefined(console.log)){console.log(c)}};a.prototype.initialize=function(){this.render()};a.prototype.onChange_visualizationClass=function(){this.render()};a.prototype.onClick_nothingFoundNotificationLink=function(c){$("#cubeviz-visualization-nothingFoundFurtherExplanation").slideDown("slow")};a.prototype.onReRender_visualization=function(){this.render()};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){if(0==_.size(this.app._.backend.retrievedObservations)){this.handleException("CubeViz error no observations retrieved");return this}var i=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts);var c=this.app._.data.selectedComponents.measure;var h=null;var f=null;if(true===_.isUndefined(i)){this.app._.ui.visualization.className=this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts[0].className;i=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts)}f=CubeViz_Visualization_Controller.updateVisualizationSettings([],this.app._.ui.visualizationSettings[this.app._.ui.visualization.className],i.defaultConfig);h=CubeViz_Visualization_Controller.getVisualizationType(this.app._.ui.visualization.className);var d=null;if((false===_.isNull(this.app._.data.selectedComponents.attribute)&&false===_.isUndefined(this.app._.data.selectedComponents.attribute))){if(false===this.app._.data.selectedComponents.attribute.__cv_inUse){}else{d=this.app._.data.selectedComponents.attribute["http://purl.org/linked-data/cube#attribute"]}}if(false===_.isUndefined(this.app._.generatedVisualization)){try{this.app._.generatedVisualization._cubeviz_configuration.onDestroy();this.app._.generatedVisualization.destroy()}catch(e){if(false===_.isUndefined(console)&&false===_.isUndefined(console.log)){console.log(e)}}}var j=new CubeViz_Visualization_HighCharts();var g=j.load(this.app._.ui.visualization.className);g.init(f,this.app._.backend.retrievedObservations,this.app._.data.selectedComponents.dimensions,CubeViz_Visualization_Controller.getMultipleDimensions(this.app._.data.selectedComponents.dimensions),CubeViz_Visualization_Controller.getOneElementDimensions(this.app._.data.selectedComponents.dimensions),c["http://purl.org/linked-data/cube#measure"],d);try{this.setVisualizationHeight(_.size(g.getRenderResult().xAxis.categories));if(0==_.size(g.getRenderResult().series)){this.handleException("CubeViz error no elements to visualize");return this}this.app._.generatedVisualization=new Highcharts.Chart(g.getRenderResult());this.app._.generatedVisualization._cubeviz_configuration=g;g.rendered(this.app._.generatedVisualization)}catch(e){this.handleException(e)}return this};a.prototype.setVisualizationHeight=function(c){if(typeof c==="undefined"){c=0}var f=$(this.attachedTo).offset();var e=$(window).height()-f.top-95;var d=0;if(0<c){d=c*40;if(d>e){e=d}}$(this.attachedTo).css("height",e)};return a})(CubeViz_View_Abstract);var View_IndexAction_VisualizationSelector=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_IndexAction_VisualizationSelector",c,d);this.bindGlobalEvents([{name:"onClick_setupComponentOpener",handler:this.onClick_setupComponentOpener},{name:"onReceived_noData",handler:this.onReceived_noData},{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application},{name:"onVisualize_noElements",handler:this.onVisualize_noElements}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);$("#cubeviz-visualizationselector-selector").empty();this.hideDongle();this.hideMenu();return this};a.prototype.hideDongle=function(){$("#cubeviz-visualizationselector-menuDongleDiv").fadeOut("slow");return this};a.prototype.hideMenu=function(){this.triggerGlobalEvent("onBeforeHide_visualizationSelectorMenu");$("#cubeviz-visualizationselector-menu").fadeOut("slow");$("#cubeviz-visualizationselector-menuItems").html("");this.triggerGlobalEvent("onAfterHide_visualizationSelectorMenu");return this};a.prototype.initialize=function(){this.render()};a.prototype.onClick_setupComponentOpener=function(){this.hideMenu()};a.prototype.onClick_closeMenu=function(){this.hideMenu()};a.prototype.onClick_selectorItem=function(e){this.triggerGlobalEvent("onBeforeClick_selectorItem");var f="";var c=null;var d=this;if(true===_.isUndefined($(e.target).data("class"))){c=$($(e.target).parent());this.app._.ui.visualization.className=c.data("class")}else{c=$(e.target);this.app._.ui.visualization.className=c.data("class")}f=$($(".cubeviz-visualizationselector-selectedSelectorItem").get(0)).data("class");this.hideDongle();if(f==this.app._.ui.visualization.className){this.showMenu(c)}else{this.hideMenu();$(".cubeviz-visualizationselector-selectedSelectorItem").removeClass("cubeviz-visualizationselector-selectedSelectorItem").addClass("cubeviz-visualizationselector-selectorItem");c.removeClass("cubeviz-visualizationselector-selectorItem").addClass("cubeviz-visualizationselector-selectedSelectorItem");this.showMenuDongle(c);this.triggerGlobalEvent("onChange_visualizationClass");CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.ui,"ui",function(g){d.app._.backend.uiHash=g})}this.triggerGlobalEvent("onAfterClick_selectorItem")};a.prototype.onClick_updateVisz=function(){var d=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts);var c=this;this.app._.ui.visualizationSettings[this.app._.ui.visualization.className]=CubeViz_Visualization_Controller.updateVisualizationSettings($(".cubeviz-visualizationselector-menuItemValue"),this.app._.ui.visualizationSettings[this.app._.ui.visualization.className],d.defaultConfig);CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.ui,"ui",function(e){c.app._.backend.uiHash=e});this.triggerGlobalEvent("onReRender_visualization")};a.prototype.onReceived_noData=function(){this.hideDongle()};a.prototype.onReRender_visualization=function(){this.destroy();if(0<_.size(this.app._.backend.retrievedObservations)){this.initialize()}};a.prototype.onStart_application=function(){if(0<_.size(this.app._.backend.retrievedObservations)){this.initialize()}};a.prototype.onVisualize_noElements=function(){this.hideDongle().hideMenu()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_visualizationSelector");var g=this.app._.data.numberOfMultipleDimensions;var f=this.app._.backend.chartConfig[g].charts;var c;var d=this;var e;this.hideDongle();_.each(f,function(h){e=$(CubeViz_View_Helper.tplReplace($("#cubeviz-visualizationselector-tpl-selectorItem").html()));$(e.find(".cubeviz-icon-small").first()).attr("src",d.app._.backend.imagesPath+h.icon);e.data("class",h.className);e.off("click");e.on("click",$.proxy(d.onClick_selectorItem,d));if(d.app._.ui.visualization.className==h.className){e.addClass("cubeviz-visualizationselector-selectedSelectorItem").removeClass("cubeviz-visualizationselector-selectorItem")}$("#cubeviz-visualizationselector-selector").append(e)});this.showMenuDongle($($("#cubeviz-visualizationselector-selector").find(".cubeviz-visualizationselector-selectedSelectorItem").first()));this.bindUserInterfaceEvents({});this.triggerGlobalEvent("onAfterRender_visualizationSelector");return this};a.prototype.showMenu=function(f){this.triggerGlobalEvent("onBeforeShow_visualizationSelectorMenu");var k=false;var i="";var e=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts);var c;var j=$("#cubeviz-visualizationselector-menuItems").html();var g=f.position();var l;var h=this.app._.ui.visualizationSettings[this.app._.ui.visualization.className];var d;if(false===_.isUndefined(e.options)&&0<_.size(e.options)&&(""==j||null==j)){_.each(e.options,function(m){k=false;c=$(CubeViz_View_Helper.tplReplace($("#cubeviz-visualizationselector-tpl-menuItem").html(),m));l=$(c.find(".cubeviz-visualizationselector-menuSelectbox").get(0));i=CubeViz_Visualization_Controller.getObjectValueByKeyString(m.key,h);d=$("<option/>");l.data("key",m.key);if(false==_.isUndefined(i)){_.each(m.values,function(n){n.value=n.value.toString();if(i.toString()==n.value&&false==k){d=$("<option/>");d.text(n.label).val(n.value).attr("selected","selected");l.append(d);k=true}})}_.each(m.values,function(n){n.value=n.value.toString();if(false==_.isUndefined(i)&&i.toString()==n.value){return}d=$("<option/>");d.text(n.label).val(n.value);if(false===k&&false===_.isUndefined(n.isDefault)&&true===n.isDefault){d.attr("selected","selected");k=true}l.append(d)});$("#cubeviz-visualizationselector-menuItems").append(c)});$("#cubeviz-visualizationselector-closeMenu").off("click");$("#cubeviz-visualizationselector-closeMenu").on("click",$.proxy(this.onClick_closeMenu,this));$("#cubeviz-visualizationselector-updateVisz").off("click");$("#cubeviz-visualizationselector-updateVisz").on("click",$.proxy(this.onClick_updateVisz,this));$("#cubeviz-visualizationselector-menu").css("top",g.top+37).css("left",g.left-192).fadeIn("slow")}this.triggerGlobalEvent("onAfterShow_visualizationSelectorMenu")};a.prototype.showMenuDongle=function(d){var f=this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts;var e=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,f);if(false===_.isUndefined(e.options)&&0<_.size(e.options)){var c=d.position();$("#cubeviz-visualizationselector-menuDongleDiv").css("top",c.top+25).css("left",c.left+14).fadeIn("slow")}};return a})(CubeViz_View_Abstract);var cubeVizApp=new CubeViz_View_Application();$(document).ready(function(){if("development"==cubeVizApp._.backend.context){console.log("cubeVizApp._:");console.log(cubeVizApp._)}cubeVizApp.triggerEvent("onStart_application")});